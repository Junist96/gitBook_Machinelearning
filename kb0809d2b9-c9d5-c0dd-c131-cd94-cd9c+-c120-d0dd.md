# 특징 생성 

특징 생성 = 특징 추출 + 특징 선택 

특징생성 정의: 외부 세하는 패턴으로부터 특징 벡터를 만드는 전체 과정 계에 존재

특징은 두 가지 기준에서 우수 해야 한다. 
- 분별력(Discriminatory): 서로 다른 부류를 잘 분별해 주어야 한다. 
- 차원(Demensionality): 차원이 낮을수록 계산 효율이 좋다. 

![](http://i.imgur.com/its92PD.png)

## 1. 특징 추출 
- 정의 : 실제 세계를 수학 세계로 바꾸어 주는 추상화 작업 

- 특징 : 추출 알고리즘들이 각 응용 분야에 의존 적이다. 

### 1.1 응용 분야별 특징 추출 방법 

#### A. 영역(Region)에서의 특징 추출 

응용분야 : 이미지 인식, 문자인식, 의료 영상 인식 

![](http://i.imgur.com/NhNSmfE.png)

##### 가. 모양에 관련한 특징 

1. 면적 : 모멘트 이용하여 계산 $$\alpha = m_{00}$$

2. 중점 : 모멘트 이용하여 계산 $$(\bar x, \bar y) = \left( \frac{m_{10}}{\alpha},\frac{m_{01}}{\alpha} \right)$$

3. 행분산 : 중심 모멘트 이용하여 계산 $$v_{rr} = \frac{\bar m_{20}}{\alpha}$$

4. 열분산 : 중심 모멘트 이용하여 계산 $$v_{cc} = \frac{\bar m_{02}}{\alpha}$$

5. 혼삽 분산 : 중심 모멘트 이용하여 계산 $$v_{rc} = \frac{\bar m_{11}}{\alpha}$$

6. 영역 둘례 : 체인코드를 이용하여 계산 $$p=n_{even}+ n_{odd}\sqrt{2} $$

7. 둥근 정도 : 영역의 둘례 + 면적 이용하여 계산  $$r=\frac{4\pi\alpha}{p^2}$$

||모멘트|중심모멘트|
|-|-|-|
|식|$$m_pq = \sum_{(x,y) \in R}x^py^q$$|모멘트의 중점을 원점으로 간주 하고 계산<br> $$\bar{m}_{pq} = \sum_{(x,y) \in R (x-\bar x)^p(y-\bar y)^q} $$
|활용|먼적(Area)구하기, 중점(Centroid)구하기|행/열/혼합 분산 정도|

![](http://i.imgur.com/UUXhlhV.png)

##### 나. 투영에 관련한 특징 

영역을 가로 방향과 세로 방향으로 투영하여 특징을 추출할 수 있다. 



###### 1. 특징벡터 
![](http://i.imgur.com/njtTJmP.png)

![](http://i.imgur.com/PjS2r1b.png)

특징 벡터 $$X = (3,3,3,3,4,4,1,2,3,6,5,3)^T$$, N+M개의 특징을 얻게 된다. (eg. 6+6 = 12차원)


###### 2. 프로파일 특징 
2(N+M)개의 특징을 얻게 된다. 

![](http://i.imgur.com/qjxbX4t.png)

![](http://i.imgur.com/kSTtnFI.png)

![](http://i.imgur.com/4LWktxy.png)


#### B. 파형(waveform)에서의 특징 추출 

응용분야 : 지진파, 주식곡선, 성적 곡선

![](http://i.imgur.com/WB6f7WD.png)

위 그림에서 a(신호 s1)과 b(신호 s2)는 서로 다른 신호 이다. 

신호는 기저 함수(c,d)의 선형 결합으로 표현 할수 있다. 

- $$S_1(x) = 0.5g_1(x)+1.5g_2(x)$$
- $$S_2(x) = 1.5g_1(x)+0.5g_2(x)$$

기저 함수의 계수(0.5 OR 1.5)로 신호를 구분 할수 있음 = 특징으로 사용 가능 
    - 하지만, 실제로는 기저 함수의 `계수`를 미리 알수 없다. 
    - `퓨리에 변환`을 이용하면 계산 할 수 있다. 

##### 가. 이산 퓨리에 변환 
목적 : 입력 신호 s(i)를 f(u)로 변환 = 시간공간을 주파수 공간으로 변환 
    - i = 시간, u = 주파수 
    - f(u) : u번째 기저 함수의 계수 

![](http://i.imgur.com/t5lpDvj.png)

##### 나. 예제 (1차원)

###### Step 1. 아날로그 신호를 샘플링 하여 디지털 신호로 변환 

![](http://i.imgur.com/UJO5cDC.png)
$$s=(1.7,0.6,1.5,1.2)^T$$

###### Step 2. 퓨리에 공식에 적용 

![](http://i.imgur.com/9wQqnfh.png)
![](http://i.imgur.com/YtICE1W.png)
- 실수부 : $$real(f(u))$$
- 허수부 : $$imag(f(u))$$

###### Step 3. 퓨리에 특징p(u) 구하기 

![](http://i.imgur.com/dATzzjV.png)

> 파워스트럼 값 = 퓨리에 특징 

![](http://i.imgur.com/FPYrQnF.png)

##### 나. 예제 (2차원)

1차원과 과정은 같으며 퓨리에 변환과 파워 스펙트럼 계산 부분만 아래 식으로 변환 한다. 

![](http://i.imgur.com/DTzNabS.png)

##### 다. 퓨리에 기술자 

- n*n 영상에 퓨리에 변환 적용하여 특징 추출

- 영역 경계 상의 점을 복소수로 표현한 뒤에 2 차원 퓨리에 변환 적용 


> 자세한 내용은 책 참고 패턴인식, 오일석, 274P


### C. 시계열 신호(Time Series)에서의 특징 추출 

응용분야 : 음성파, 지진파, 주식 시세 

특징 : 동적인 성질을 가지고 있음 (cf. 영상신호 = 정적인 성질)

절차 : 시계열 신호를 프레임 단위로 나누고 각각의 프레임에서 특징 벡터를 추출 

추출 알고리즘 : 퓨리에 변환 활용 (시계열 신호 역시 주파수 + 진폭 이므로)
    - 최근에는 퓨리보다 분별력이 우수한 `갭스트럼(Cepstrum)` 특징 주로 이용 


### 1.2 PCA를 이용한 특징 추출 방법 
 
- 기존[1.1 응용 분야별 특징 추출 방법]은 주어진 데이터에서 바로 특징 추출 

- PCA는 훈련 집합을 이용하여 매개 변수를 추정하고 이를 변환식에 적용 

> PCA 특징 추출은 Karhumen-loeve(KL)변환, Hotelling 변환이라고도 불리운다. 

#### A. 개요 

목적 : PCA는 데이터(D차원)를 낮은 차원의 특징 벡터 X로(d차원) 변환 (d<D)
    - 변환은 단위벡터 u축으로 `투영`함으로써 가능 
    - 이때 정보 손실을 최소화 하여야 함 
    
공식 : $$\hat x = u^Ts$$
- s : 데이터 
- u : 투영 되는 축 
- $$\hat x$$ : 투영된 값 

최적화 요소 : `분산`, 원래 공간에 퍼져 있는 정도를 투영된 공간에서도 얼마나 잘 유지 하는가 

#### B. 예제

![](http://i.imgur.com/Ivu5S1I.png)

데이터 $$X = {(2,1)^T,(2,4)^T,(4,1)^T,(4,3)^T} \Rightarrow$$ 속 빈 점 

투영 되는 축 
- a : $$u^T=(1,0)$$ 축
- b : $$u^T=(0,1)$$ 축
- c : $$u^T=(a/\sqrt{2},2/\sqrt{2})$$ 축

투영된 값 
- a 축으로 투영 : 분산 1.0
    - 투영시 $$S_2,S_1$$은 2로변환, $$S_3, S_4$$는 4로 변환 된다. 
    - 즉, $$S_2,S_1$$가 같은 점으로 거리/위치 등의 `정보 손실`이 발생 한다. 

    ![](http://i.imgur.com/NPH0WvR.png)

- c 축으로 투영 : 분산 1.0938

    ![](http://i.imgur.com/rFheRiH.png)


정보 손실
- a축으로 투영시 $$S_2,S_1$$은 2로변환, $$S_3, S_4$$는 4로 같은 한점으로 표시 되어 거리/위치 등의 `정보 손실`이 발생

- a(분산 1.0)보다  c(분산 1.0938)가 정보 손실이 더 적다 



#### C. 최적화된 투영 축 찾기 

###### Step 1. 최적화 목표 정의 

변환된 샘플들의 분산을 최대화 하는 축 

###### Step 2. 분산을 계산 하는 법 찾기

![](http://i.imgur.com/u9Hc4BN.png)

평균은 원래 신호들의 평균벡터$$\bar S$$를 구한다음 그것을 $$u$$로 투영 한것이고 
분산은 이 값을 활용하면 구할수 있음

###### Step 3. 최적화 함수 정의 

목표 재 정의 : 식(30)의 분산 $$\hat \sigma^2$$을 최대화 하는 u를 찾아라 
    - 이때, u가 단위 벡터 이므로 $$uu^T=1$$이라는 조건을 만들수 있음 (???억지로라도 조건을 만들어야 하나?)
    
조건부 최적화 문제(=라그랑제 승수활용)
![](http://i.imgur.com/0DpuOk4.png)


###### Step 4. 미분하고 수식 정리 

![](http://i.imgur.com/999tDvp.png)
> 3번째의 가로안은 공분산 행렬이다. 이를 4번째 줄에서 $$\sum(공분산 기호)$$로 대치 하였다. 

###### Step 5. 최종식 

라그랑제 상수 L(u)를 최대화 하는 U는 $$\frac{\partial L(U)}{\partial} =0$$을 만족 해야 하므로 , $$\frac{\partial \sum\mu - 2\lambda \mu}{\partial} =0  $$

즉, $$\sum\mu = 2\lambda \mu $$이다. 이를 잘 살펴 보면 
- $$\mu$$는 공분산 행렬 $$\sum$$의 고유 벡터(eigenvector)
- $$\lambda$$는 고유 값(eigenvalue)

|결론: 훈련집합의 공분산 행렬 구하기 -> 공분산 행렬의 고유 벡터 구하기 -> 최대 분산 u |
|-|









## 2. 특징 선택



































