# 확률 분포 추정 

베이즈 정리 = $$P(\omega_i \mid X ) = \frac{p(X\mid \omega_i)P(\omega_i}{p(X)} = \frac{우도 \times 사전확률}{p(X)}$$

- 베이즈 정리를 완성 하려면 `우도` 값을 알아야함
- 우도값은 데이터의 분포를 가정할수 있다면 쉽게 가능 
    - 쉬운 이유 : 분포의 매개 변수만 알면 가능 

|우도 | $$p(X\mid \omega_i)$$|분류 i일때 데이터가 X일 확률 
|-|-|

우도 구하는 법(확률 분포 추정 하는법??)
![](http://i.imgur.com/3RQirUn.png)
- MAP: 최대 사후 확률 
- ML : 최대 우도 

## 1. 최대 우도(ML)

### 1.1 개요 
- 1992년 R.A. Fisher 제안

- 확률 추정 문제 = 최대 우도를 갖는 매개 변수를 찾는 문제 = 최대 우도 방법(ML method)
    - 즉, 주어진 X를 발생 시켰을때 가능성이 가장 높은 매개변수 집합($$\Phi$$)를 찾아라 

![](http://i.imgur.com/vZTi68X.png)
위 예에서 
- P(X| Θ1)>P(X| Θ2)
- 최대 우도를 갖는 Θ는?

#### A. 공식

$$
ML\ method = \hat\Phi = argmax_\Phi p(X|\Phi)

$$

#### B. 문제 풀이 

|원식|$$argmax_\Phi p(X|\Phi)$$|
|-|-|
|풀어쓰기|![](http://i.imgur.com/CURnf16.png)<br>- $$X={x_1,x_1,..,x_N}$$|
|로그 우도 변환($$\ln$$취하기)|![](http://i.imgur.com/yhBVK32.png)<br>- $$\prod{}{} \rightarrow \sum{}{}$$로 변한건 Log의 곱성질 때문인가?|
|최적화 문제 이므로 미분 이용|![](http://i.imgur.com/36fk8Wr.png)<br>- 최적문제 : L($$\Phi$$)의 도함수를 0으로 두고 풀어 구한 답이 $$\hat\Phi$$

#### C. [참고] MAP방법

- 위 공식은 P($$\Phi$$)가 균일하다고 가정하고 있다. 

- 만약 P($$\Phi$$) 정보가 사용가능하고 균일 하지 않다면 P($$\Phi$$)를 식에 추가 하여야 한다. 

![](http://i.imgur.com/R6Nul8J.png)

식에서 P($$x_i \mid \Phi$$)를 우도로 , P($$\Phi$$)를 사전 확률로 본다면 P($$x_i \mid \Phi$$)P($$\Phi$$)는 사후확률로 간주 할수 있다. 
- 이 수식을 풀어서 최적의 매개 변수를 찾는 방법을 MAP라 한다. 

||ML방법|MAP방법|
|-|-|-|
|사전확률|균일|균일하지 않음|
|공식|![](http://i.imgur.com/yhBVK32.png)|![](http://i.imgur.com/R6Nul8J.png)|
|최적해 위치가 다름|![](http://i.imgur.com/T5qe9aZ.png)|![](http://i.imgur.com/qsTiGif.png)<br>- 사전 확률이 균일하지 않은 영향을 받아 최적해가 오른쪽으로 이동|







### 1.2 ML 활용 가능 알고리즘 
- EM 알고리즘 
- Baum-Welch 알고리즘

> ML은 메타 휴리스틱(=응용에 따라 내부 알고리즘 대체) 이므로 